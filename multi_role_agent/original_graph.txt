graph LR
    subgraph AWS Resources
        aws_vpc[aws_vpc] --> aws_subnet[aws_subnet]
        aws_vpc --> aws_internet_gateway[aws_internet_gateway]
        aws_route_table[aws_route_table] --> aws_internet_gateway
        aws_route_table --> aws_vpc
        aws_route_table_association[aws_route_table_association] --> aws_subnet
        aws_route_table_association --> aws_route_table
        aws_instance[aws_instance] --> aws_subnet
        aws_instance --> aws_security_group[aws_security_group]
        aws_instance --> aws_iam_instance_profile[aws_iam_instance_profile]
        aws_security_group --> aws_vpc
        aws_s3_bucket[aws_s3_bucket]
        aws_iam_policy[aws_iam_policy] --> aws_s3_bucket
        aws_iam_role[aws_iam_role]
        aws_iam_role_policy_attachment[aws_iam_role_policy_attachment] --> aws_iam_role
        aws_iam_role_policy_attachment --> aws_iam_policy
        aws_iam_instance_profile --> aws_iam_role
    end

    subgraph IAM Permissions
        aws_iam_policy -- Allows --> aws_s3_bucket
        aws_iam_role -- Assumed by --> aws_instance
    end

    style AWS fill:#f9f,stroke:#333,stroke-width:2px
